{"version":3,"sources":["pages/dashboard/EcommerceShop.js"],"names":["EcommerceShop","themeStretch","useSettings","dispatch","useDispatch","useState","openFilter","setOpenFilter","useSelector","state","product","products","sortBy","filters","filteredProducts","orderBy","gender","length","filter","_product","includes","category","colors","some","color","priceRange","price","rating","convertRating","value","totalRating","applyFilter","formik","useFormik","initialValues","onSubmit","values","a","setSubmitting","Promise","resolve","setTimeout","console","error","resetForm","handleSubmit","isSubmitting","isDefault","useEffect","getProducts","filterProducts","handleResetFilter","title","open","sx","zIndex","maxWidth","heading","links","name","href","PATH_DASHBOARD","root","eCommerce","spacing","direction","xs","sm","alignItems","justifyContent","mb","flexShrink","my","isOpenFilter","onResetFilter","onOpenFilter","onCloseFilter","variant","gutterBottom","isShowReset"],"mappings":"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","file":"static/js/119.162c4bfb.chunk.js","sourcesContent":["import { useFormik } from 'formik';\nimport { useEffect, useState } from 'react';\nimport { filter, includes, orderBy } from 'lodash';\n// @mui\nimport { Backdrop, Container, Typography, CircularProgress, Stack } from '@mui/material';\n// redux\nimport { useDispatch, useSelector } from '../../redux/store';\nimport { getProducts, filterProducts } from '../../redux/slices/product';\n// routes\nimport { PATH_DASHBOARD } from '../../routes/paths';\n// hooks\nimport useSettings from '../../hooks/useSettings';\n// components\nimport Page from '../../components/Page';\nimport HeaderBreadcrumbs from '../../components/HeaderBreadcrumbs';\n// sections\nimport {\n  ShopTagFiltered,\n  ShopProductSort,\n  ShopProductList,\n  ShopFilterSidebar,\n  ShopProductSearch,\n} from '../../sections/@dashboard/e-commerce/shop';\nimport CartWidget from '../../sections/@dashboard/e-commerce/CartWidget';\n\n// ----------------------------------------------------------------------\n\nexport default function EcommerceShop() {\n  const { themeStretch } = useSettings();\n  const dispatch = useDispatch();\n  const [openFilter, setOpenFilter] = useState(false);\n  const { products, sortBy, filters } = useSelector((state) => state.product);\n\n  const filteredProducts = applyFilter(products, sortBy, filters);\n\n  const formik = useFormik({\n    initialValues: {\n      gender: filters.gender,\n      category: filters.category,\n      colors: filters.colors,\n      priceRange: filters.priceRange,\n      rating: filters.rating,\n    },\n    onSubmit: async (values, { setSubmitting }) => {\n      try {\n        await new Promise((resolve) => setTimeout(resolve, 500));\n        setSubmitting(false);\n      } catch (error) {\n        console.error(error);\n        setSubmitting(false);\n      }\n    },\n  });\n\n  const { values, resetForm, handleSubmit, isSubmitting } = formik;\n\n  const isDefault =\n    !values.priceRange &&\n    !values.rating &&\n    values.gender.length === 0 &&\n    values.colors.length === 0 &&\n    values.category === 'All';\n\n  useEffect(() => {\n    dispatch(getProducts());\n  }, [dispatch]);\n\n  useEffect(() => {\n    dispatch(filterProducts(values));\n  }, [dispatch, values]);\n\n  const handleOpenFilter = () => {\n    setOpenFilter(true);\n  };\n\n  const handleCloseFilter = () => {\n    setOpenFilter(false);\n  };\n\n  const handleResetFilter = () => {\n    handleSubmit();\n    resetForm();\n  };\n\n  return (\n    <Page title=\"Ecommerce: Shop\">\n      {values && (\n        <Backdrop open={isSubmitting} sx={{ zIndex: 9999 }}>\n          <CircularProgress />\n        </Backdrop>\n      )}\n\n      <Container maxWidth={themeStretch ? false : 'lg'}>\n        <HeaderBreadcrumbs\n          heading=\"Shop\"\n          links={[\n            { name: 'Dashboard', href: PATH_DASHBOARD.root },\n            {\n              name: 'E-Commerce',\n              href: PATH_DASHBOARD.eCommerce.root,\n            },\n            { name: 'Shop' },\n          ]}\n        />\n\n        <Stack\n          spacing={2}\n          direction={{ xs: 'column', sm: 'row' }}\n          alignItems={{ sm: 'center' }}\n          justifyContent=\"space-between\"\n          sx={{ mb: 2 }}\n        >\n          <ShopProductSearch />\n\n          <Stack direction=\"row\" spacing={1} flexShrink={0} sx={{ my: 1 }}>\n            <ShopFilterSidebar\n              formik={formik}\n              isOpenFilter={openFilter}\n              onResetFilter={handleResetFilter}\n              onOpenFilter={handleOpenFilter}\n              onCloseFilter={handleCloseFilter}\n            />\n            <ShopProductSort />\n          </Stack>\n        </Stack>\n\n        <Stack sx={{ mb: 3 }}>\n          {!isDefault && (\n            <>\n              <Typography variant=\"body2\" gutterBottom>\n                <strong>{filteredProducts.length}</strong>\n                &nbsp;Products found\n              </Typography>\n\n              <ShopTagFiltered\n                filters={filters}\n                formik={formik}\n                isShowReset={openFilter}\n                onResetFilter={handleResetFilter}\n                isDefault={isDefault}\n              />\n            </>\n          )}\n        </Stack>\n\n        <ShopProductList products={filteredProducts} isDefault={isDefault} />\n        <CartWidget />\n      </Container>\n    </Page>\n  );\n}\n\n// ----------------------------------------------------------------------\n\nfunction applyFilter(products, sortBy, filters) {\n  // SORT BY\n  if (sortBy === 'featured') {\n    products = orderBy(products, ['sold'], ['desc']);\n  }\n  if (sortBy === 'newest') {\n    products = orderBy(products, ['createdAt'], ['desc']);\n  }\n  if (sortBy === 'priceDesc') {\n    products = orderBy(products, ['price'], ['desc']);\n  }\n  if (sortBy === 'priceAsc') {\n    products = orderBy(products, ['price'], ['asc']);\n  }\n  // FILTER PRODUCTS\n  if (filters.gender.length > 0) {\n    products = filter(products, (_product) => includes(filters.gender, _product.gender));\n  }\n  if (filters.category !== 'All') {\n    products = filter(products, (_product) => _product.category === filters.category);\n  }\n  if (filters.colors.length > 0) {\n    products = filter(products, (_product) => _product.colors.some((color) => filters.colors.includes(color)));\n  }\n  if (filters.priceRange) {\n    products = filter(products, (_product) => {\n      if (filters.priceRange === 'below') {\n        return _product.price < 25;\n      }\n      if (filters.priceRange === 'between') {\n        return _product.price >= 25 && _product.price <= 75;\n      }\n      return _product.price > 75;\n    });\n  }\n  if (filters.rating) {\n    products = filter(products, (_product) => {\n      const convertRating = (value) => {\n        if (value === 'up4Star') return 4;\n        if (value === 'up3Star') return 3;\n        if (value === 'up2Star') return 2;\n        return 1;\n      };\n      return _product.totalRating > convertRating(filters.rating);\n    });\n  }\n  return products;\n}\n"],"sourceRoot":""}